From d2f8a6153a5f799ecf3c2c7d714d14f7810bb667 Mon Sep 17 00:00:00 2001
From: "Philip, Avinash" <avinashphilip@ti.com>
Date: Tue, 6 Mar 2012 09:26:36 +0530
Subject: [PATCH 072/172] Revert "arm:omap:nand - Updated JFFS2 clean marker
 offset."

This reverts commit e536110d5dd555a2f67131a16a111505da8280e6.
---
 drivers/mtd/nand/omap2.c |    9 +++++----
 1 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/drivers/mtd/nand/omap2.c b/drivers/mtd/nand/omap2.c
index 17056d6..4e5073b 100644
--- a/drivers/mtd/nand/omap2.c
+++ b/drivers/mtd/nand/omap2.c
@@ -96,7 +96,6 @@
 #define P4o_s(a)	(TF(a & NAND_Ecc_P4o)		<< 1)
 
 #define MAX_HWECC_BYTES_OOB_64     24
-#define JFFS2_CLEAN_MARKER_OFFSET  0x2
 
 int decode_bch(int select_4_8, unsigned char *ecc, unsigned int *err_loc);
 
@@ -1135,10 +1134,12 @@ static int __devinit omap_nand_probe(struct platform_device *pdev)
 	/* select ecc lyout */
 	if (info->nand.ecc.mode != NAND_ECC_SOFT) {
 
-		if (!(info->nand.options & NAND_BUSWIDTH_16))
+		if (info->nand.options & NAND_BUSWIDTH_16)
+			offset = 2;
+		else {
+			offset = 1;
 			info->nand.badblock_pattern = &bb_descrip_flashbased;
-
-		offset = JFFS2_CLEAN_MARKER_OFFSET;
+		}
 
 		if (info->mtd.oobsize == 64)
 			omap_oobinfo.eccbytes = info->nand.ecc.bytes *
-- 
1.7.9.1

