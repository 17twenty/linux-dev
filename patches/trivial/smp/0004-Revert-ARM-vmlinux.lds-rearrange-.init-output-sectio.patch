From a4a1e1feef69d166778eadeabec956b672eb770d Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Tue, 26 Jul 2011 15:31:03 -0500
Subject: [PATCH 4/5] Revert "ARM: vmlinux.lds: rearrange .init output section"

This reverts commit 1604d79d372bcf0cf1aebcbdee251bd0f3d56665.
---
 arch/arm/kernel/vmlinux.lds.S |   47 +++++++++++++++-------------------------
 1 files changed, 18 insertions(+), 29 deletions(-)

diff --git a/arch/arm/kernel/vmlinux.lds.S b/arch/arm/kernel/vmlinux.lds.S
index c8bb9b7..cb46a9b 100644
--- a/arch/arm/kernel/vmlinux.lds.S
+++ b/arch/arm/kernel/vmlinux.lds.S
@@ -65,59 +65,48 @@ SECTIONS
 #else
 	. = PAGE_OFFSET + TEXT_OFFSET;
 #endif
-	.head.text : {
+
+	.init : {			/* Init code and data		*/
 		_stext = .;
-		HEAD_TEXT
-	}
-	INIT_TEXT_SECTION(8)
-	.exit.text : {
-		ARM_EXIT_KEEP(EXIT_TEXT)
-	}
-	.init.proc.info : {
+		_sinittext = .;
+			HEAD_TEXT
+			INIT_TEXT
+			ARM_EXIT_KEEP(EXIT_TEXT)
+		_einittext = .;
 		ARM_CPU_DISCARD(PROC_INFO)
-	}
-	.init.arch.info : {
 		__arch_info_begin = .;
-		*(.arch.info.init)
+			*(.arch.info.init)
 		__arch_info_end = .;
-	}
-	.init.tagtable : {
 		__tagtable_begin = .;
-		*(.taglist.init)
+			*(.taglist.init)
 		__tagtable_end = .;
-	}
 #ifdef CONFIG_SMP_ON_UP
-	.init.smpalt : {
 		__smpalt_begin = .;
-		*(.alt.smp.init)
+			*(.alt.smp.init)
 		__smpalt_end = .;
-	}
 #endif
-	.init.pv_table : {
+
 		__pv_table_begin = .;
-		*(.pv_table)
+			*(.pv_table)
 		__pv_table_end = .;
-	}
-	.init.data : {
-#ifndef CONFIG_XIP_KERNEL
-		INIT_DATA
-#endif
+
 		INIT_SETUP(16)
+
 		INIT_CALLS
 		CON_INITCALL
 		SECURITY_INITCALL
 		INIT_RAM_FS
-	}
+
 #ifndef CONFIG_XIP_KERNEL
-	.exit.data : {
+		__init_begin = _stext;
+		INIT_DATA
 		ARM_EXIT_KEEP(EXIT_DATA)
-	}
 #endif
+	}
 
 	PERCPU_SECTION(32)
 
 #ifndef CONFIG_XIP_KERNEL
-	__init_begin = _stext;
 	. = ALIGN(PAGE_SIZE);
 	__init_end = .;
 #endif
-- 
1.7.4.1

